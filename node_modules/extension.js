const express = require('express');
const bodyParser = require('body-parser'); 
const app = express();
const path = require('path');
const router = express.Router()
app.set("view engine", "pug")


// Parse url-encoded and JSON request bodies
app.use(express.static(__dirname+'/public'));//for images

app.use(bodyParser.urlencoded({ extended: true }));
app.use(bodyParser.json());

app.use(express.urlencoded());

app.get('/experience1', function(req,res){ //buttons click call function
	const path = require('path');
	const parentDir = path.dirname(__dirname);
	res.sendFile(parentDir+'\\experience1.html')
});
app.get('/experience2', function(req,res){
	const path = require('path');
	const parentDir = path.dirname(__dirname);
	res.sendFile(parentDir+'\\experience2.html')
});
app.get('/', function(request, response, next){
	const path = require('path');
// Current directory
console.log(__dirname);

// Parent directory
const parentDir = path.dirname(__dirname);
	response.sendFile(parentDir + '\\resume.html');

	/*response.send(`
		<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
		<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
		<div class="container">
			<h1 class="text-center mt-3 mb-3">Submit Form Data in Node.js</h1>
			<div class="card">
				<div class="card-header">Sample Form</div>
				<div class="card-body">
					<form method="POST" action="/">
						<div class="mb-3">
							<label>First Name</label>
							<input type="text" name="first_name" id="first_name" class="form-control" />
						</div>
						<div class="mb-3">
							<label>Last Name</label>
							<input type="text" name="last_name" id="last_name" class="form-control" />
						</div>
						<div class="mb-3">
		                	<label>Email Address</label>
		                	<input type="text" name="email_address" id="email_address" class="form-control" />
		                </div>
		                <div class="mb-3">
		                	<input type="submit" name="submit_button" class="btn btn-primary" value="Add" />
		                </div>
					</form>
				</div>
			</div>
		</div>
	`);*/


});



app.post('/', function(request, response, next){

 var bodytext=request.body;
 const data = JSON.stringify(request.body);
 
    // Load the Nodemailer module
const nodemailer = require('nodemailer');

// Create a transporter object that will provide mail transport service(s)
let transporter = nodemailer.createTransport({
    service: 'gmail',
    auth: {
        user: 'sunkaravijaya98@gmail.com',
        pass: 'aeadopbgidbjlboo'
    }
});

// Define the email message content and options
let mailOptions = {
    from: 'sunkaravijaya98@gmail.com',
    to: 'vxs71630@ucmo.edu',
    subject: 'hello testing',
    text: data
};

// Use the transporter object to send this email message
transporter.sendMail(mailOptions, function(error, info){
    if (error) {
        console.log(error);
    } else {
        console.log('Email sent successfully: ' + info.response);
    }
});



	response.send(request.body);

});

app.listen(2000);

